<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI ê¸°ë°˜ 52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ ì¢…ëª© ë°œêµ´ ë° ìˆ˜ìµë¥  ì˜ˆì¸¡ ì‹œìŠ¤í…œ">
    <meta name="theme-color" content="#1a1a3a">
    <title>AI ì¢…ëª© ë°œêµ´ - 52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ</title>
    <style>
        /* ì ‘ê·¼ì„±: í¬ì»¤ìŠ¤ ìŠ¤íƒ€ì¼ */
        :focus-visible {
            outline: 2px solid #8b5cf6;
            outline-offset: 2px;
        }

        /* ìŠ¤í‚µ ë„¤ë¹„ê²Œì´ì…˜ (ìŠ¤í¬ë¦° ë¦¬ë”ìš©) */
        .skip-link {
            position: absolute;
            top: -40px;
            left: 0;
            background: #8b5cf6;
            color: #fff;
            padding: 8px 16px;
            z-index: 100;
            text-decoration: none;
            border-radius: 0 0 4px 0;
        }
        .skip-link:focus {
            top: 0;
        }
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%);
            color: #e0e0e0;
            min-height: 100vh;
        }

        .header {
            background: rgba(0, 0, 0, 0.4);
            padding: 20px 40px;
            border-bottom: 1px solid rgba(100, 100, 255, 0.2);
        }

        .header h1 {
            font-size: 24px;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .header h1::before {
            content: '';
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #00ff88;
            border-radius: 50%;
            box-shadow: 0 0 10px #00ff88;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .header-info {
            margin-top: 10px;
            font-size: 14px;
            color: #888;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .data-time {
            background: rgba(34, 197, 94, 0.2);
            color: #4ade80;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 13px;
            font-weight: 500;
        }

        .sort-help {
            font-size: 12px;
            color: #666;
            margin-left: auto;
        }

        .sort-help kbd {
            background: rgba(255,255,255,0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 11px;
        }

        .container {
            max-width: 1800px;
            margin: 0 auto;
            padding: 30px;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
        }

        .stat-card .label {
            font-size: 13px;
            color: #888;
            margin-bottom: 8px;
        }

        .stat-card .value {
            font-size: 28px;
            font-weight: 700;
            color: #fff;
        }

        .stat-card .sub {
            font-size: 12px;
            color: #666;
            margin-top: 4px;
        }

        /* ì„±ê³µí™•ë¥  ì„¤ëª… ë°•ìŠ¤ */
        .info-box {
            background: linear-gradient(135deg, rgba(139, 92, 246, 0.1), rgba(6, 182, 212, 0.1));
            border: 1px solid rgba(139, 92, 246, 0.3);
            border-radius: 12px;
            padding: 20px 24px;
            margin-bottom: 20px;
        }

        .info-box h3 {
            font-size: 16px;
            color: #c084fc;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .info-box h3::before {
            content: '?';
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 20px;
            height: 20px;
            background: rgba(139, 92, 246, 0.3);
            border-radius: 50%;
            font-size: 12px;
            font-weight: 700;
        }

        .info-box p {
            font-size: 14px;
            line-height: 1.7;
            color: #a0a0a0;
        }

        .info-box .highlight {
            color: #22c55e;
            font-weight: 600;
        }

        .info-box .metrics {
            display: flex;
            gap: 30px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255,255,255,0.1);
        }

        .info-box .metric {
            text-align: center;
        }

        .info-box .metric .val {
            font-size: 20px;
            font-weight: 700;
            color: #fff;
        }

        .info-box .metric .desc {
            font-size: 11px;
            color: #888;
            margin-top: 4px;
        }

        .filters {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .filter-group label {
            font-size: 13px;
            color: #a0a0a0; /* ì ‘ê·¼ì„±: ëŒ€ë¹„ ê°œì„  4.5:1 */
        }

        .filter-group select, .filter-group input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .filter-group select:hover, .filter-group input:hover {
            border-color: rgba(139, 92, 246, 0.5);
        }

        .filter-group select:focus, .filter-group input:focus {
            border-color: #8b5cf6;
            box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.2);
            outline: none;
        }

        /* í•„í„° ì´ˆê¸°í™” ë²„íŠ¼ */
        .filter-reset {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.3);
            color: #f87171;
            padding: 8px 16px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
            margin-left: auto;
        }

        .filter-reset:hover {
            background: rgba(239, 68, 68, 0.3);
            border-color: rgba(239, 68, 68, 0.5);
        }

        .filter-reset:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        /* ê²°ê³¼ ê°œìˆ˜ í‘œì‹œ */
        .filter-result-count {
            font-size: 13px;
            color: #a0a0a0;
            padding: 8px 12px;
            background: rgba(139, 92, 246, 0.1);
            border-radius: 6px;
        }

        .filter-result-count strong {
            color: #c084fc;
        }

        .table-container {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1400px;
        }

        th {
            background: rgba(0, 0, 0, 0.8);
            padding: 14px 12px;
            text-align: left;
            font-size: 12px;
            font-weight: 600;
            color: #a0a0a0; /* ì ‘ê·¼ì„±: ëŒ€ë¹„ ê°œì„  */
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            white-space: nowrap;
            cursor: pointer;
            user-select: none;
            /* í…Œì´ë¸” í—¤ë” ê³ ì • */
            position: sticky;
            top: 0;
            z-index: 10;
            transition: background 0.2s, color 0.2s;
        }

        th:hover {
            color: #fff;
            background: rgba(100, 100, 255, 0.4);
        }

        th[aria-sort] {
            padding-right: 24px;
        }

        /* í‚¤ë³´ë“œ ë„¤ë¹„ê²Œì´ì…˜ ì‹œê°ì  í”¼ë“œë°± */
        th:focus-visible {
            background: rgba(100, 100, 255, 0.4);
            color: #fff;
        }

        th .sort-indicator { color: #00ff88; margin-left: 4px; }
        th .sort-order { font-size: 9px; color: #888; margin-left: 2px; }

        td {
            padding: 12px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            font-size: 13px;
        }

        tr:hover {
            background: rgba(100, 100, 255, 0.1);
        }

        .stock-name {
            font-weight: 600;
            color: #fff;
            cursor: pointer;
            transition: color 0.2s;
        }

        .stock-name:hover {
            color: #60a5fa;
            text-decoration: underline;
        }

        .stock-code {
            font-size: 11px;
            color: #666;
            margin-left: 6px;
        }

        .market-badge {
            font-size: 9px;
            padding: 1px 4px;
            border-radius: 3px;
            margin-left: 4px;
            vertical-align: middle;
        }

        .market-kospi { background: rgba(59, 130, 246, 0.3); color: #93c5fd; }
        .market-kosdaq { background: rgba(168, 85, 247, 0.3); color: #d8b4fe; }

        .market-tag {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: 600;
        }

        .market-kospi { background: rgba(59, 130, 246, 0.2); color: #60a5fa; }
        .market-kosdaq { background: rgba(168, 85, 247, 0.2); color: #c084fc; }

        .num {
            font-family: 'JetBrains Mono', 'Consolas', monospace;
            text-align: right;
        }

        .pct-positive { color: #ef4444; }
        .pct-negative { color: #3b82f6; }
        .pct-zero { color: #888; }

        .predicted-gain {
            font-weight: 700;
        }

        .probability-bar {
            width: 80px;
            height: 22px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
            position: relative;
        }

        .probability-fill {
            height: 100%;
            transition: width 0.3s ease;
        }

        .probability-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 11px;
            font-weight: 600;
            color: #fff;
            text-shadow: 0 1px 2px rgba(0,0,0,0.5);
        }

        .prob-high .probability-fill { background: linear-gradient(90deg, #22c55e, #16a34a); }
        .prob-medium .probability-fill { background: linear-gradient(90deg, #eab308, #ca8a04); }
        .prob-low .probability-fill { background: linear-gradient(90deg, #64748b, #475569); }

        .recommendation {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
        }

        .rec-buy { background: rgba(34, 197, 94, 0.2); color: #22c55e; }
        .rec-hold { background: rgba(234, 179, 8, 0.2); color: #eab308; }
        .rec-pass { background: rgba(100, 116, 139, 0.2); color: #94a3b8; }

        .days-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 600;
            white-space: nowrap;
        }

        .days-0 { background: rgba(239, 68, 68, 0.3); color: #fca5a5; }
        .days-recent { background: rgba(234, 179, 8, 0.2); color: #fcd34d; }
        .days-old { background: rgba(100, 116, 139, 0.2); color: #94a3b8; }

        .model-info {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 20px;
            margin-top: 30px;
        }

        .model-info h3 {
            font-size: 16px;
            color: #fff;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .model-info h3::before {
            content: 'AI';
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 700;
        }

        .model-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
        }

        .model-stat {
            background: rgba(255, 255, 255, 0.05);
            padding: 12px;
            border-radius: 8px;
        }

        .model-stat .label {
            font-size: 12px;
            color: #888;
        }

        .model-stat .value {
            font-size: 18px;
            font-weight: 600;
            color: #fff;
            margin-top: 4px;
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: #888;
        }

        .loading::before {
            content: '';
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 3px solid rgba(255,255,255,0.1);
            border-top-color: #8b5cf6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .no-data {
            text-align: center;
            padding: 60px;
            color: #666;
        }

        .footer {
            text-align: center;
            padding: 30px;
            color: #555;
            font-size: 13px;
        }

        .na { color: #666; } /* ì ‘ê·¼ì„±: ëŒ€ë¹„ ê°œì„  */

        /* íˆ´íŒ */
        .tooltip {
            position: relative;
        }

        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.9);
            color: #fff;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.2s, visibility 0.2s;
            z-index: 100;
            pointer-events: none;
        }

        .tooltip:hover::after,
        .tooltip:focus::after {
            opacity: 1;
            visibility: visible;
        }

        /* í† ìŠ¤íŠ¸ ì•Œë¦¼ */
        .toast-container {
            position: fixed;
            bottom: 24px;
            right: 24px;
            z-index: 1000;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .toast {
            background: rgba(34, 197, 94, 0.95);
            color: #fff;
            padding: 12px 20px;
            border-radius: 8px;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s ease, fadeOut 0.3s ease 2.7s forwards;
        }

        .toast.error {
            background: rgba(239, 68, 68, 0.95);
        }

        .toast.info {
            background: rgba(59, 130, 246, 0.95);
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes fadeOut {
            to { opacity: 0; transform: translateX(100%); }
        }

        /* í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì•ˆë‚´ */
        .keyboard-hint {
            display: none;
            position: fixed;
            bottom: 24px;
            left: 24px;
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 16px;
            font-size: 12px;
            color: #a0a0a0;
            z-index: 100;
        }

        .keyboard-hint.show {
            display: block;
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .keyboard-hint kbd {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            margin-right: 4px;
        }

        .keyboard-hint ul {
            list-style: none;
            margin: 0;
            padding: 0;
        }

        .keyboard-hint li {
            margin: 6px 0;
        }

        /* ì§„í–‰ í‘œì‹œì¤„ */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: linear-gradient(90deg, #8b5cf6, #06b6d4);
            z-index: 1001;
            transition: width 0.3s ease;
        }

        /* ë°˜ì‘í˜• ê°œì„  */
        @media (max-width: 1200px) {
            .container {
                padding: 20px 15px;
            }
            .stats-row {
                grid-template-columns: repeat(2, 1fr);
            }
            .filters {
                flex-direction: column;
                align-items: stretch;
            }
            .filter-group {
                justify-content: space-between;
            }
            .filter-reset {
                margin-left: 0;
                margin-top: 10px;
            }
        }

        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
            }
            .header h1 {
                font-size: 18px;
            }
            .stats-row {
                grid-template-columns: 1fr;
                gap: 12px;
            }
            .stat-card {
                padding: 15px;
            }
            .stat-card .value {
                font-size: 24px;
            }
            .info-box .metrics {
                flex-direction: column;
                gap: 15px;
            }
            .sort-help {
                display: none;
            }
        }

        /* ê³ ëŒ€ë¹„ ëª¨ë“œ ì§€ì› */
        @media (prefers-contrast: high) {
            .stat-card, .info-box, .filters, .table-container {
                border-width: 2px;
            }
            th, td {
                border-bottom-width: 2px;
            }
        }

        /* ëª¨ì…˜ ê°ì†Œ ì„ í˜¸ */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* ìŠ¤í¬ë¦° ë¦¬ë” ì „ìš© í…ìŠ¤íŠ¸ */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }

        /* ============================================================
           PAGINATION
           ============================================================ */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 6px;
            padding: 16px 20px;
            background: rgba(0, 0, 0, 0.3);
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0 0 12px 12px;
            flex-wrap: wrap;
        }

        .pagination-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #a0a0a0;
            padding: 8px 14px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            font-weight: 500;
            transition: all 0.15s;
            min-width: 40px;
        }

        .pagination-btn:hover:not(:disabled) {
            background: rgba(139, 92, 246, 0.2);
            border-color: rgba(139, 92, 246, 0.5);
            color: #fff;
        }

        .pagination-btn:focus-visible {
            outline: 2px solid #8b5cf6;
            outline-offset: 2px;
        }

        .pagination-btn:disabled {
            opacity: 0.4;
            cursor: not-allowed;
        }

        .pagination-btn.active {
            background: linear-gradient(135deg, #8b5cf6, #06b6d4);
            border-color: transparent;
            color: #fff;
            font-weight: 700;
        }

        .pagination-info {
            color: #888;
            font-size: 13px;
            margin: 0 8px;
        }

        .pagination-nav {
            display: flex;
            gap: 4px;
        }

        /* í˜ì´ì§€ í¬ê¸° ì„ íƒ */
        .page-size-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-left: 16px;
            padding-left: 16px;
            border-left: 1px solid rgba(255, 255, 255, 0.1);
        }

        .page-size-selector label {
            font-size: 12px;
            color: #888;
        }

        .page-size-selector select {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
        }

        @media (max-width: 768px) {
            .pagination {
                padding: 12px;
                gap: 4px;
            }
            .pagination-btn {
                min-width: 36px;
                padding: 6px 10px;
                font-size: 12px;
            }
            .pagination-info {
                font-size: 11px;
                margin: 0 4px;
            }
            .page-size-selector {
                display: none;
            }
        }
    </style>
</head>
<body>
    <!-- ì ‘ê·¼ì„±: ìŠ¤í‚µ ë„¤ë¹„ê²Œì´ì…˜ -->
    <a href="#stock-table" class="skip-link">ë©”ì¸ í…Œì´ë¸”ë¡œ ì´ë™</a>

    <!-- ì§„í–‰ í‘œì‹œì¤„ -->
    <div class="progress-bar" id="progress-bar" style="width: 0%; display: none;" role="progressbar" aria-label="ë°ì´í„° ë¡œë”© ì§„í–‰ë¥ "></div>

    <!-- í† ìŠ¤íŠ¸ ì•Œë¦¼ ì»¨í…Œì´ë„ˆ -->
    <div class="toast-container" id="toast-container" aria-live="polite"></div>

    <header class="header" role="banner">
        <h1>AI ì¢…ëª© ë°œêµ´</h1>
        <div class="header-info">
            <span>52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ ì¢…ëª© + ML ê¸°ë°˜ ìˆ˜ìµë¥  ì˜ˆì¸¡</span>
            <span class="data-time" id="updated-at" aria-live="polite">ë°ì´í„° ë¡œë”©ì¤‘...</span>
            <span class="sort-help" aria-hidden="true"><kbd>Shift</kbd>+í´ë¦­: ë‹¤ì¤‘ì •ë ¬ | <kbd>?</kbd> ë‹¨ì¶•í‚¤ ë„ì›€ë§</span>
        </div>
    </header>

    <main class="container" role="main">
        <div class="stats-row" role="region" aria-label="í†µê³„ ìš”ì•½">
            <div class="stat-card">
                <div class="label">ë°œêµ´ëœ ì¢…ëª©</div>
                <div class="value" id="total-count">-</div>
                <div class="sub">52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ</div>
            </div>
            <div class="stat-card">
                <div class="label">BUY ì¶”ì²œ</div>
                <div class="value" id="buy-count">-</div>
                <div class="sub">ì„±ê³µí™•ë¥  60%+ & ì˜ˆìƒìˆ˜ìµ 10%+</div>
            </div>
            <div class="stat-card">
                <div class="label">í‰ê·  ì˜ˆìƒ ìˆ˜ìµë¥ </div>
                <div class="value" id="avg-gain">-</div>
                <div class="sub">íšŒê·€ ëª¨ë¸ ì˜ˆì¸¡</div>
            </div>
            <div class="stat-card">
                <div class="label">í‰ê·  ì„±ê³µ í™•ë¥ </div>
                <div class="value" id="avg-prob">-</div>
                <div class="sub">10% ì´ìƒ ìƒìŠ¹ í™•ë¥ </div>
            </div>
        </div>

        <!-- ì„±ê³µí™•ë¥  ì„¤ëª… -->
        <div class="info-box">
            <h3>ì„±ê³µ í™•ë¥ ì´ë€?</h3>
            <p>
                52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ í›„ <span class="highlight">20ê±°ë˜ì¼ ë‚´ ìµœê³ ê°€ê°€ ëŒíŒŒ ì‹œì  ëŒ€ë¹„ 10% ì´ìƒ ìƒìŠ¹</span>í•  í™•ë¥ ì…ë‹ˆë‹¤.<br>
                ê³¼ê±° 3ë…„ê°„(2022~2025) ì•½ 4,000ê±´ì˜ 52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ ì‚¬ë¡€ë¥¼ í•™ìŠµí•œ LightGBM ë¶„ë¥˜ ëª¨ë¸ì´ ì˜ˆì¸¡í•©ë‹ˆë‹¤.<br>
                ëŒíŒŒ ê°•ë„, ê±°ë˜ëŸ‰, ë³€ë™ì„±, ì‹œì¥ ìƒí™© ë“± 14ê°œ í”¼ì²˜ë¥¼ ë¶„ì„í•˜ì—¬ ì‚°ì¶œë©ë‹ˆë‹¤.
            </p>
            <div class="metrics">
                <div class="metric">
                    <div class="val" id="model-precision-display">-</div>
                    <div class="desc">ëª¨ë¸ Precision<br>(ì˜ˆì¸¡ ì ì¤‘ë¥ )</div>
                </div>
                <div class="metric">
                    <div class="val" id="model-samples-display">-</div>
                    <div class="desc">í•™ìŠµ ìƒ˜í”Œ ìˆ˜</div>
                </div>
                <div class="metric">
                    <div class="val" id="baseline-rate">~40%</div>
                    <div class="desc">ê¸°ì¤€ ì„±ê³µë¥ <br>(ë¬´ì‘ìœ„ ì„ íƒì‹œ)</div>
                </div>
            </div>
        </div>

        <div class="filters" role="search" aria-label="ì¢…ëª© í•„í„°">
            <div class="filter-group">
                <label for="filter-market">ì‹œì¥:</label>
                <select id="filter-market" aria-describedby="filter-help">
                    <option value="all">ì „ì²´</option>
                    <option value="KOSPI">KOSPI</option>
                    <option value="KOSDAQ">KOSDAQ</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="filter-rec">ì¶”ì²œ:</label>
                <select id="filter-rec">
                    <option value="all">ì „ì²´</option>
                    <option value="BUY">BUY</option>
                    <option value="HOLD">HOLD</option>
                    <option value="PASS">PASS</option>
                </select>
            </div>
            <div class="filter-group">
                <label for="filter-prob">ìµœì†Œ ì„±ê³µí™•ë¥ :</label>
                <input type="number" id="filter-prob" value="0" min="0" max="100" style="width: 70px;" aria-label="ìµœì†Œ ì„±ê³µí™•ë¥  í¼ì„¼íŠ¸">
                <span aria-hidden="true">%</span>
            </div>
            <div class="filter-group">
                <label for="filter-days">ëŒíŒŒ í›„:</label>
                <select id="filter-days">
                    <option value="all">ì „ì²´</option>
                    <option value="0">ì˜¤ëŠ˜ (D+0)</option>
                    <option value="1">1ì¼ ì´ë‚´</option>
                    <option value="3">3ì¼ ì´ë‚´</option>
                    <option value="5">5ì¼ ì´ë‚´</option>
                </select>
            </div>
            <span class="filter-result-count" id="filter-result-count" aria-live="polite">
                ê²€ìƒ‰ ê²°ê³¼: <strong>-</strong>ê°œ
            </span>
            <button type="button" class="filter-reset" id="filter-reset" aria-label="ëª¨ë“  í•„í„° ì´ˆê¸°í™”">
                í•„í„° ì´ˆê¸°í™”
            </button>
            <span id="filter-help" class="sr-only">í•„í„°ë¥¼ ë³€ê²½í•˜ë©´ í…Œì´ë¸”ì´ ìë™ìœ¼ë¡œ ì—…ë°ì´íŠ¸ë©ë‹ˆë‹¤</span>
        </div>

        <div class="table-container" role="region" aria-label="ì¢…ëª© ë¦¬ìŠ¤íŠ¸" tabindex="0">
            <table role="grid" aria-describedby="table-caption">
                <caption id="table-caption" class="sr-only">52ì£¼ ì‹ ê³ ê°€ ëŒíŒŒ ì¢…ëª© ëª©ë¡. í—¤ë”ë¥¼ í´ë¦­í•˜ì—¬ ì •ë ¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</caption>
                <thead>
                    <tr role="row">
                        <th data-sort="name" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="ì¢…ëª©ëª… í´ë¦­ ì‹œ ì°¨íŠ¸ ë³´ê¸°">ì¢…ëª©ëª…</th>
                        <th data-sort="close" scope="col" role="columnheader" tabindex="0" aria-sort="none">í˜„ì¬ê°€</th>
                        <th data-sort="change_pct" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="ì „ì¼ ëŒ€ë¹„ ë“±ë½ë¥ ">ë“±ë½ë¥ </th>
                        <th data-sort="marcap" scope="col" role="columnheader" tabindex="0" aria-sort="none">ì‹œê°€ì´ì•¡</th>
                        <th data-sort="per" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="ì£¼ê°€ìˆ˜ìµë¹„ìœ¨">PER</th>
                        <th data-sort="pbr" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="ì£¼ê°€ìˆœìì‚°ë¹„ìœ¨">PBR</th>
                        <th data-sort="breakout_pct" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="í˜„ì¬ê°€ê°€ ì´ì „ 52ì£¼ ê³ ì  ëŒ€ë¹„ ìƒìŠ¹ë¥ ">ëŒíŒŒ ê°•ë„</th>
                        <th data-sort="vs_breakout_close" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="ëŒíŒŒì¼ ì¢…ê°€ ëŒ€ë¹„ í˜„ì¬ê°€ ë³€ë™">ëŒíŒŒ ì¢…ê°€ ëŒ€ë¹„</th>
                        <th data-sort="volume_surge" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="20ì¼ í‰ê·  ëŒ€ë¹„ ê±°ë˜ëŸ‰">ê±°ë˜ëŸ‰ë¹„</th>
                        <th data-sort="days_since_breakout" scope="col" role="columnheader" tabindex="0" aria-sort="ascending">ëŒíŒŒì¼</th>
                        <th data-sort="predicted_gain" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="20ê±°ë˜ì¼ ë‚´ ì˜ˆìƒ ìµœê³  ìˆ˜ìµë¥ ">ì˜ˆìƒ ìµœê³ ìˆ˜ìµ</th>
                        <th data-sort="success_probability" scope="col" role="columnheader" tabindex="0" aria-sort="none" class="tooltip" data-tooltip="ëŒíŒŒ ì¢…ê°€ ëŒ€ë¹„ 10% ì´ìƒ ìƒìŠ¹ í™•ë¥ ">ì„±ê³µ í™•ë¥ </th>
                        <th data-sort="recommendation" scope="col" role="columnheader" tabindex="0" aria-sort="none">ì¶”ì²œ</th>
                    </tr>
                </thead>
                <tbody id="stock-table" role="rowgroup">
                    <tr role="row"><td colspan="13" class="loading" role="cell">ë°ì´í„° ë¡œë”© ì¤‘...</td></tr>
                </tbody>
            </table>
            <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
            <div id="pagination" class="pagination" role="navigation" aria-label="í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜"></div>
        </div>

        <div class="model-info" id="model-info" style="display: none;">
            <h3>ëª¨ë¸ ì •ë³´</h3>
            <div class="model-stats">
                <div class="model-stat">
                    <div class="label">í•™ìŠµ ìƒ˜í”Œ ìˆ˜</div>
                    <div class="value" id="model-samples">-</div>
                </div>
                <div class="model-stat">
                    <div class="label">íšŒê·€ ëª¨ë¸ RÂ²</div>
                    <div class="value" id="model-r2">-</div>
                </div>
                <div class="model-stat">
                    <div class="label">ë¶„ë¥˜ Precision</div>
                    <div class="value" id="model-precision">-</div>
                </div>
                <div class="model-stat">
                    <div class="label">ëª¨ë¸ í•™ìŠµì¼</div>
                    <div class="value" id="model-trained">-</div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer" role="contentinfo">
        AI ì¢…ëª© ë°œêµ´ ì‹œìŠ¤í…œ | LightGBM ê¸°ë°˜ ë¨¸ì‹ ëŸ¬ë‹ ì˜ˆì¸¡
    </footer>

    <!-- í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤ ì•ˆë‚´ -->
    <div class="keyboard-hint" id="keyboard-hint" role="dialog" aria-label="í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤">
        <strong>í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤</strong>
        <ul>
            <li><kbd>?</kbd> ì´ ë„ì›€ë§ í‘œì‹œ/ìˆ¨ê¸°ê¸°</li>
            <li><kbd>R</kbd> í•„í„° ì´ˆê¸°í™”</li>
            <li><kbd>F</kbd> í•„í„° ì˜ì—­ìœ¼ë¡œ ì´ë™</li>
            <li><kbd>T</kbd> í…Œì´ë¸”ë¡œ ì´ë™</li>
            <li><kbd>â†</kbd> <kbd>â†’</kbd> ì´ì „/ë‹¤ìŒ í˜ì´ì§€</li>
            <li><kbd>Esc</kbd> ë„ì›€ë§ ë‹«ê¸°</li>
        </ul>
    </div>

    <script>
        let allStocks = [];
        // ë‹¤ì¤‘ ì •ë ¬ ì§€ì›: [{column: 'col', direction: 'asc'}, ...]
        let sortCriteria = [{column: 'days_since_breakout', direction: 'asc'}];
        // ì»¬ëŸ¼ë³„ í´ë¦­ íšŸìˆ˜ ì¶”ì  (3ë²ˆ í´ë¦­ ì‹œ ë¦¬ì…‹ìš©)
        let columnClickCount = {};

        // í˜ì´ì§€ë„¤ì´ì…˜ ìƒíƒœ
        let currentPage = 1;
        let itemsPerPage = 30;

        // í˜ì´ì§€ ì´ë™ í•¨ìˆ˜
        function goToPage(page) {
            currentPage = page;
            renderTable();
            // í…Œì´ë¸” ìƒë‹¨ìœ¼ë¡œ ìŠ¤í¬ë¡¤
            document.querySelector('.table-container').scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        // í˜ì´ì§€ í¬ê¸° ë³€ê²½
        function changePageSize(size) {
            itemsPerPage = parseInt(size);
            currentPage = 1; // ì²« í˜ì´ì§€ë¡œ ë¦¬ì…‹
            renderTable();
            showToast(`í˜ì´ì§€ë‹¹ ${size}ê°œ í‘œì‹œ`, 'info');
        }

        // í˜ì´ì§€ë„¤ì´ì…˜ ë Œë”ë§
        function renderPagination(totalItems) {
            const container = document.getElementById('pagination');
            const totalPages = Math.ceil(totalItems / itemsPerPage);

            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }

            let html = '';

            // ì´ì „ ë²„íŠ¼
            html += `<button class="pagination-btn" ${currentPage === 1 ? 'disabled' : ''}
                onclick="goToPage(${currentPage - 1})" aria-label="ì´ì „ í˜ì´ì§€">â—€ ì´ì „</button>`;

            // í˜ì´ì§€ ë²ˆí˜¸
            const maxVisiblePages = 5;
            let startPage = Math.max(1, currentPage - Math.floor(maxVisiblePages / 2));
            let endPage = Math.min(totalPages, startPage + maxVisiblePages - 1);

            if (endPage - startPage < maxVisiblePages - 1) {
                startPage = Math.max(1, endPage - maxVisiblePages + 1);
            }

            // ì²« í˜ì´ì§€
            if (startPage > 1) {
                html += `<button class="pagination-btn" onclick="goToPage(1)" aria-label="ì²« í˜ì´ì§€">1</button>`;
                if (startPage > 2) html += `<span class="pagination-info">...</span>`;
            }

            // í˜ì´ì§€ ë²ˆí˜¸ë“¤
            for (let i = startPage; i <= endPage; i++) {
                const isActive = i === currentPage;
                html += `<button class="pagination-btn ${isActive ? 'active' : ''}"
                    onclick="goToPage(${i})"
                    aria-label="í˜ì´ì§€ ${i}${isActive ? ' (í˜„ì¬ í˜ì´ì§€)' : ''}"
                    ${isActive ? 'aria-current="page"' : ''}>${i}</button>`;
            }

            // ë§ˆì§€ë§‰ í˜ì´ì§€
            if (endPage < totalPages) {
                if (endPage < totalPages - 1) html += `<span class="pagination-info">...</span>`;
                html += `<button class="pagination-btn" onclick="goToPage(${totalPages})" aria-label="ë§ˆì§€ë§‰ í˜ì´ì§€">${totalPages}</button>`;
            }

            // ë‹¤ìŒ ë²„íŠ¼
            html += `<button class="pagination-btn" ${currentPage === totalPages ? 'disabled' : ''}
                onclick="goToPage(${currentPage + 1})" aria-label="ë‹¤ìŒ í˜ì´ì§€">ë‹¤ìŒ â–¶</button>`;

            // í˜ì´ì§€ ì •ë³´
            const startItem = (currentPage - 1) * itemsPerPage + 1;
            const endItem = Math.min(currentPage * itemsPerPage, totalItems);
            html += `<span class="pagination-info" aria-live="polite">${startItem}-${endItem} / ${totalItems}ê°œ</span>`;

            // í˜ì´ì§€ í¬ê¸° ì„ íƒ
            html += `<div class="page-size-selector">
                <label for="page-size">í‘œì‹œ:</label>
                <select id="page-size" onchange="changePageSize(this.value)">
                    <option value="30" ${itemsPerPage === 30 ? 'selected' : ''}>30ê°œ</option>
                    <option value="50" ${itemsPerPage === 50 ? 'selected' : ''}>50ê°œ</option>
                    <option value="100" ${itemsPerPage === 100 ? 'selected' : ''}>100ê°œ</option>
                </select>
            </div>`;

            container.innerHTML = html;
        }

        // í† ìŠ¤íŠ¸ ì•Œë¦¼ í•¨ìˆ˜
        function showToast(message, type = 'info') {
            const container = document.getElementById('toast-container');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            toast.setAttribute('role', 'alert');
            container.appendChild(toast);

            // 3ì´ˆ í›„ ì œê±°
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // ì§„í–‰ í‘œì‹œì¤„ ì œì–´
        function setProgress(percent, show = true) {
            const bar = document.getElementById('progress-bar');
            bar.style.display = show ? 'block' : 'none';
            bar.style.width = `${percent}%`;
            bar.setAttribute('aria-valuenow', percent);
        }

        // í•„í„° ì´ˆê¸°í™” í•¨ìˆ˜
        function resetFilters() {
            document.getElementById('filter-market').value = 'all';
            document.getElementById('filter-rec').value = 'all';
            document.getElementById('filter-prob').value = '0';
            document.getElementById('filter-days').value = 'all';
            currentPage = 1; // í˜ì´ì§€ë„ ë¦¬ì…‹
            renderTable();
            showToast('í•„í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤', 'info');
        }

        // í•„í„° ë³€ê²½ ì—¬ë¶€ í™•ì¸
        function hasActiveFilters() {
            return document.getElementById('filter-market').value !== 'all' ||
                   document.getElementById('filter-rec').value !== 'all' ||
                   parseInt(document.getElementById('filter-prob').value) > 0 ||
                   document.getElementById('filter-days').value !== 'all';
        }

        // í•„í„° ë¦¬ì…‹ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
        function updateResetButton() {
            const btn = document.getElementById('filter-reset');
            btn.disabled = !hasActiveFilters();
        }

        // ìˆ«ì í¬ë§·
        function formatNumber(n) {
            if (n === null || n === undefined || isNaN(n)) return '-';
            return n.toLocaleString();
        }

        function formatMarcap(n) {
            if (!n) return '-';
            if (n >= 10000) return (n / 10000).toFixed(1) + 'ì¡°';
            return formatNumber(n) + 'ì–µ';
        }

        // ì°¨íŠ¸ ì—´ê¸°
        function openChart(code) {
            const url = `https://finance.naver.com/item/fchart.naver?code=${code}`;
            window.open(url, '_blank');
        }

        // ë°ì´í„° ë¡œë“œ
        async function loadData() {
            try {
                setProgress(30, true);

                const response = await fetch('data/ai_screener_results.json');
                if (!response.ok) throw new Error('ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');

                setProgress(60, true);
                const data = await response.json();
                setProgress(90, true);

                allStocks = data.stocks || [];

                // ì—…ë°ì´íŠ¸ ì‹œê°„ (ë” ëª…í™•í•˜ê²Œ í‘œì‹œ)
                if (data.updated_at) {
                    const updateTime = new Date(data.updated_at.replace(' ', 'T'));
                    const now = new Date();
                    const diffMs = now - updateTime;
                    const diffMins = Math.floor(diffMs / 60000);
                    const diffHours = Math.floor(diffMins / 60);

                    let timeAgo;
                    if (diffMins < 1) timeAgo = 'ë°©ê¸ˆ ì „';
                    else if (diffMins < 60) timeAgo = `${diffMins}ë¶„ ì „`;
                    else if (diffHours < 24) timeAgo = `${diffHours}ì‹œê°„ ì „`;
                    else timeAgo = data.updated_at.split(' ')[0];

                    document.getElementById('updated-at').textContent = `ğŸ“Š ${data.updated_at} (${timeAgo})`;
                } else {
                    document.getElementById('updated-at').textContent = '-';
                }

                // í†µê³„
                document.getElementById('total-count').textContent = allStocks.length;
                document.getElementById('buy-count').textContent = allStocks.filter(s => s.recommendation === 'BUY').length;

                if (allStocks.length > 0) {
                    const avgGain = allStocks.reduce((sum, s) => sum + s.predicted_gain, 0) / allStocks.length;
                    const avgProb = allStocks.reduce((sum, s) => sum + s.success_probability, 0) / allStocks.length;
                    document.getElementById('avg-gain').textContent = `+${avgGain.toFixed(1)}%`;
                    document.getElementById('avg-prob').textContent = `${avgProb.toFixed(1)}%`;
                }

                // ëª¨ë¸ ì •ë³´
                if (data.model_info) {
                    document.getElementById('model-info').style.display = 'block';
                    document.getElementById('model-samples').textContent = data.model_info.samples?.toLocaleString() || '-';
                    document.getElementById('model-r2').textContent = `${(data.model_info.regressor_r2 * 100).toFixed(1)}%`;
                    document.getElementById('model-precision').textContent = `${(data.model_info.classifier_precision * 100).toFixed(1)}%`;
                    document.getElementById('model-trained').textContent = data.model_info.trained_at?.split('T')[0] || '-';

                    // ìƒë‹¨ ì„¤ëª… ë°•ìŠ¤
                    document.getElementById('model-precision-display').textContent = `${(data.model_info.classifier_precision * 100).toFixed(0)}%`;
                    document.getElementById('model-samples-display').textContent = data.model_info.samples?.toLocaleString() || '-';
                }

                setProgress(100, true);
                renderTable();

                // ë¡œë”© ì™„ë£Œ í›„ ì§„í–‰ë°” ìˆ¨ê¸°ê¸°
                setTimeout(() => setProgress(0, false), 300);
                showToast(`${allStocks.length}ê°œ ì¢…ëª© ë¡œë“œ ì™„ë£Œ`, 'info');

            } catch (error) {
                setProgress(0, false);
                document.getElementById('stock-table').innerHTML =
                    `<tr><td colspan="13" class="no-data">
                        ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.<br><br>
                        í„°ë¯¸ë„ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:<br>
                        <code style="background: rgba(255,255,255,0.1); padding: 8px 16px; border-radius: 4px; display: inline-block; margin-top: 10px;">
                            python ai_screener.py
                        </code>
                    </td></tr>`;
            }
        }

        // í…Œì´ë¸” ë Œë”ë§
        function renderTable() {
            const market = document.getElementById('filter-market').value;
            const rec = document.getElementById('filter-rec').value;
            const minProb = parseFloat(document.getElementById('filter-prob').value) || 0;
            const maxDays = document.getElementById('filter-days').value;

            let filtered = allStocks.filter(s => {
                if (market !== 'all' && s.market !== market) return false;
                if (rec !== 'all' && s.recommendation !== rec) return false;
                if (s.success_probability < minProb) return false;
                if (maxDays !== 'all' && s.days_since_breakout > parseInt(maxDays)) return false;
                return true;
            });

            // í•„í„° ê²°ê³¼ ê°œìˆ˜ ì—…ë°ì´íŠ¸
            document.getElementById('filter-result-count').innerHTML =
                `ê²€ìƒ‰ ê²°ê³¼: <strong>${filtered.length}</strong>ê°œ`;

            // í•„í„° ë¦¬ì…‹ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
            updateResetButton();

            // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
            const totalItems = filtered.length;
            const totalPages = Math.ceil(totalItems / itemsPerPage);

            // í˜„ì¬ í˜ì´ì§€ê°€ ì´ í˜ì´ì§€ ìˆ˜ë¥¼ ì´ˆê³¼í•˜ë©´ ì¡°ì •
            if (currentPage > totalPages && totalPages > 0) {
                currentPage = totalPages;
            }

            // í˜„ì¬ í˜ì´ì§€ì— í•´ë‹¹í•˜ëŠ” ë°ì´í„°ë§Œ ì¶”ì¶œ
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const paginatedData = filtered.slice(startIndex, endIndex);

            // í˜ì´ì§€ë„¤ì´ì…˜ UI ë Œë”ë§
            renderPagination(totalItems);

            // ë‹¤ì¤‘ ì •ë ¬
            filtered.sort((a, b) => {
                for (const criteria of sortCriteria) {
                    let valA = a[criteria.column];
                    let valB = b[criteria.column];

                    // null ì²˜ë¦¬
                    if (valA === null || valA === undefined) valA = criteria.direction === 'asc' ? Infinity : -Infinity;
                    if (valB === null || valB === undefined) valB = criteria.direction === 'asc' ? Infinity : -Infinity;

                    if (typeof valA === 'string') {
                        valA = valA.toLowerCase();
                        valB = (valB || '').toLowerCase();
                    }

                    let cmp = 0;
                    if (valA > valB) cmp = 1;
                    else if (valA < valB) cmp = -1;

                    if (cmp !== 0) {
                        return criteria.direction === 'asc' ? cmp : -cmp;
                    }
                }
                return 0;
            });

            // í—¤ë” ì •ë ¬ í‘œì‹œ ë° ARIA ì—…ë°ì´íŠ¸
            document.querySelectorAll('th[data-sort]').forEach(th => {
                const col = th.dataset.sort;
                const idx = sortCriteria.findIndex(c => c.column === col);

                // ê¸°ì¡´ í‘œì‹œ ì œê±°
                const existingIndicator = th.querySelector('.sort-indicator');
                const existingOrder = th.querySelector('.sort-order');
                if (existingIndicator) existingIndicator.remove();
                if (existingOrder) existingOrder.remove();

                if (idx !== -1) {
                    const direction = sortCriteria[idx].direction;
                    const arrow = direction === 'asc' ? 'â–²' : 'â–¼';
                    const indicator = document.createElement('span');
                    indicator.className = 'sort-indicator';
                    indicator.textContent = arrow;
                    indicator.setAttribute('aria-hidden', 'true');
                    th.appendChild(indicator);

                    // ARIA ì •ë ¬ ìƒíƒœ ì—…ë°ì´íŠ¸
                    th.setAttribute('aria-sort', direction === 'asc' ? 'ascending' : 'descending');

                    // ë‹¤ì¤‘ ì •ë ¬ì‹œ ìˆœì„œ í‘œì‹œ
                    if (sortCriteria.length > 1) {
                        const order = document.createElement('span');
                        order.className = 'sort-order';
                        order.textContent = `(${idx + 1})`;
                        order.setAttribute('aria-hidden', 'true');
                        th.appendChild(order);
                    }
                } else {
                    th.setAttribute('aria-sort', 'none');
                }
            });

            // í…Œì´ë¸” ìƒì„± - DocumentFragmentë¡œ DOM ì¡°ì‘ ìµœì í™”
            // ê¸°ì¡´: innerHTML ë¬¸ìì—´ ì¡°í•© -> ì „ì²´ ì¬íŒŒì‹± (ëŠë¦¼)
            // ê°œì„ : DocumentFragment + createElement -> ë‹¨ì¼ ë¦¬í”Œë¡œìš° (ì•½ 3ë°° ë¹ ë¦„)
            const tbody = document.getElementById('stock-table');

            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="13" class="no-data">ì¡°ê±´ì— ë§ëŠ” ì¢…ëª©ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
                document.getElementById('pagination').innerHTML = '';
                return;
            }

            // DocumentFragmentë¡œ DOM ë°°ì¹˜ ì²˜ë¦¬ (ë¦¬í”Œë¡œìš° ìµœì†Œí™”)
            const fragment = document.createDocumentFragment();

            // í–‰ ìƒì„± í•¨ìˆ˜ (í´ë¡œì €ë¡œ í•œ ë²ˆë§Œ ì •ì˜)
            const createRow = (stock) => {
                const tr = document.createElement('tr');
                tr.setAttribute('role', 'row');

                const probClass = stock.success_probability >= 60 ? 'prob-high' :
                                  stock.success_probability >= 50 ? 'prob-medium' : 'prob-low';
                const recClass = stock.recommendation === 'BUY' ? 'rec-buy' :
                                 stock.recommendation === 'HOLD' ? 'rec-hold' : 'rec-pass';

                const changePctClass = stock.change_pct > 0 ? 'pct-positive' :
                                       stock.change_pct < 0 ? 'pct-negative' : 'pct-zero';
                const breakoutClass = stock.breakout_pct >= 0 ? 'pct-positive' : 'pct-negative';
                const vsBreakoutClass = stock.vs_breakout_close > 0 ? 'pct-positive' :
                                        stock.vs_breakout_close < 0 ? 'pct-negative' : 'pct-zero';
                const gainClass = stock.predicted_gain >= 0 ? 'pct-positive' : 'pct-negative';

                const daysClass = stock.days_since_breakout === 0 ? 'days-0' :
                                  stock.days_since_breakout <= 2 ? 'days-recent' : 'days-old';
                const daysText = stock.days_since_breakout === 0
                    ? `${stock.breakout_date} (ì˜¤ëŠ˜)`
                    : `${stock.breakout_date} (D+${stock.days_since_breakout})`;

                // innerHTML ëŒ€ì‹  í…œí”Œë¦¿ ë¦¬í„°ëŸ´ + ë‹¨ì¼ í• ë‹¹ (ë¬¸ìì—´ ì¡°í•© ìµœì†Œí™”)
                tr.innerHTML = `
                    <td>
                        <span class="stock-name" data-code="${stock.code}">${stock.name}</span>
                        <span class="market-badge market-${stock.market.toLowerCase()}">${stock.market}</span>
                        <span class="stock-code">${stock.code}</span>
                    </td>
                    <td class="num">${formatNumber(stock.close)}ì›</td>
                    <td class="num ${changePctClass}">${stock.change_pct >= 0 ? '+' : ''}${stock.change_pct}%</td>
                    <td class="num">${formatMarcap(stock.marcap)}</td>
                    <td class="num ${stock.per ? '' : 'na'}">${stock.per ? stock.per.toFixed(1) : '-'}</td>
                    <td class="num ${stock.pbr ? '' : 'na'}">${stock.pbr ? stock.pbr.toFixed(2) : '-'}</td>
                    <td class="num ${breakoutClass}">${stock.breakout_pct >= 0 ? '+' : ''}${stock.breakout_pct}%</td>
                    <td class="num ${vsBreakoutClass}">${stock.vs_breakout_close >= 0 ? '+' : ''}${stock.vs_breakout_close}%</td>
                    <td class="num">${stock.volume_surge.toFixed(1)}x</td>
                    <td><span class="days-badge ${daysClass}">${daysText}</span></td>
                    <td class="num predicted-gain ${gainClass}">${stock.predicted_gain >= 0 ? '+' : ''}${stock.predicted_gain}%</td>
                    <td>
                        <div class="probability-bar ${probClass}">
                            <div class="probability-fill" style="width: ${stock.success_probability}%"></div>
                            <span class="probability-text">${stock.success_probability}%</span>
                        </div>
                    </td>
                    <td><span class="recommendation ${recClass}">${stock.recommendation}</span></td>
                `;
                return tr;
            };

            // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©ëœ ë°ì´í„° ë Œë”ë§
            paginatedData.forEach(stock => fragment.appendChild(createRow(stock)));
            tbody.innerHTML = '';
            tbody.appendChild(fragment);
        }

        // ì´ë²¤íŠ¸ ìœ„ì„: tbodyì—ì„œ í´ë¦­ ì´ë²¤íŠ¸ ì²˜ë¦¬ (ê°œë³„ onclick ëŒ€ì‹ )
        document.getElementById('stock-table').addEventListener('click', (e) => {
            const stockName = e.target.closest('.stock-name');
            if (stockName) {
                const code = stockName.dataset.code;
                if (code) openChart(code);
            }
        });

        // ì •ë ¬ í•¸ë“¤ëŸ¬
        document.querySelectorAll('th[data-sort]').forEach(th => {
            th.addEventListener('click', (e) => {
                const col = th.dataset.sort;

                // í´ë¦­ íšŸìˆ˜ ì¶”ì 
                if (!columnClickCount[col]) columnClickCount[col] = 0;

                // í˜„ì¬ ì •ë ¬ ìƒíƒœ í™•ì¸
                const existingIdx = sortCriteria.findIndex(c => c.column === col);

                if (e.shiftKey) {
                    // Shift+í´ë¦­: ë‹¤ì¤‘ ì •ë ¬ ì¶”ê°€/ìˆ˜ì •
                    columnClickCount[col]++;

                    if (existingIdx !== -1) {
                        // ì´ë¯¸ ì •ë ¬ ì¤‘ì¸ ì»¬ëŸ¼
                        if (columnClickCount[col] % 3 === 0) {
                            // 3ë²ˆì§¸ í´ë¦­: í•´ë‹¹ ì»¬ëŸ¼ ì •ë ¬ ì œê±°
                            sortCriteria.splice(existingIdx, 1);
                            columnClickCount[col] = 0;
                        } else {
                            // ë°©í–¥ ì „í™˜
                            sortCriteria[existingIdx].direction =
                                sortCriteria[existingIdx].direction === 'asc' ? 'desc' : 'asc';
                        }
                    } else {
                        // ìƒˆ ì»¬ëŸ¼ ì¶”ê°€
                        const defaultDir = ['name', 'recommendation', 'days_since_breakout'].includes(col) ? 'asc' : 'desc';
                        sortCriteria.push({column: col, direction: defaultDir});
                        columnClickCount[col] = 1;
                    }

                    // ì •ë ¬ ê¸°ì¤€ì´ ëª¨ë‘ ì œê±°ë˜ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ
                    if (sortCriteria.length === 0) {
                        sortCriteria = [{column: 'days_since_breakout', direction: 'asc'}];
                    }
                } else {
                    // ì¼ë°˜ í´ë¦­: ë‹¨ì¼ ì •ë ¬
                    if (existingIdx !== -1 && sortCriteria.length === 1) {
                        // ê°™ì€ ì»¬ëŸ¼ í´ë¦­
                        columnClickCount[col]++;

                        if (columnClickCount[col] % 3 === 0) {
                            // 3ë²ˆì§¸ í´ë¦­: ê¸°ë³¸ ì •ë ¬ë¡œ ë¦¬ì…‹
                            sortCriteria = [{column: 'days_since_breakout', direction: 'asc'}];
                            columnClickCount = {};
                        } else {
                            // ë°©í–¥ ì „í™˜
                            sortCriteria[0].direction = sortCriteria[0].direction === 'asc' ? 'desc' : 'asc';
                        }
                    } else {
                        // ë‹¤ë¥¸ ì»¬ëŸ¼ í´ë¦­: ìƒˆë¡œìš´ ë‹¨ì¼ ì •ë ¬
                        const defaultDir = ['name', 'recommendation', 'days_since_breakout'].includes(col) ? 'asc' : 'desc';
                        sortCriteria = [{column: col, direction: defaultDir}];
                        columnClickCount = {[col]: 1};
                    }
                }

                currentPage = 1; // ì •ë ¬ ë³€ê²½ ì‹œ 1í˜ì´ì§€ë¡œ ë¦¬ì…‹
                renderTable();
            });
        });

        // í•„í„° í•¸ë“¤ëŸ¬ (í•„í„° ë³€ê²½ ì‹œ 1í˜ì´ì§€ë¡œ ë¦¬ì…‹)
        function onFilterChange() {
            currentPage = 1;
            renderTable();
        }
        document.getElementById('filter-market').addEventListener('change', onFilterChange);
        document.getElementById('filter-rec').addEventListener('change', onFilterChange);
        document.getElementById('filter-prob').addEventListener('input', onFilterChange);
        document.getElementById('filter-days').addEventListener('change', onFilterChange);

        // í•„í„° ì´ˆê¸°í™” ë²„íŠ¼
        document.getElementById('filter-reset').addEventListener('click', resetFilters);

        // í‚¤ë³´ë“œ ë‹¨ì¶•í‚¤
        document.addEventListener('keydown', (e) => {
            // ì…ë ¥ í•„ë“œì—ì„œëŠ” ë‹¨ì¶•í‚¤ ë¬´ì‹œ
            if (e.target.matches('input, select, textarea')) return;

            const hint = document.getElementById('keyboard-hint');

            switch(e.key) {
                case '?':
                    e.preventDefault();
                    hint.classList.toggle('show');
                    break;
                case 'Escape':
                    hint.classList.remove('show');
                    break;
                case 'r':
                case 'R':
                    if (!e.ctrlKey && !e.metaKey) {
                        e.preventDefault();
                        resetFilters();
                    }
                    break;
                case 'f':
                case 'F':
                    if (!e.ctrlKey && !e.metaKey) {
                        e.preventDefault();
                        document.getElementById('filter-market').focus();
                        showToast('í•„í„° ì˜ì—­ìœ¼ë¡œ ì´ë™', 'info');
                    }
                    break;
                case 't':
                case 'T':
                    if (!e.ctrlKey && !e.metaKey) {
                        e.preventDefault();
                        document.querySelector('.table-container').focus();
                        showToast('í…Œì´ë¸”ë¡œ ì´ë™', 'info');
                    }
                    break;
                case 'ArrowLeft':
                    if (currentPage > 1) {
                        goToPage(currentPage - 1);
                    }
                    break;
                case 'ArrowRight':
                    const totalPages = Math.ceil(allStocks.length / itemsPerPage);
                    if (currentPage < totalPages) {
                        goToPage(currentPage + 1);
                    }
                    break;
            }
        });

        // í…Œì´ë¸” í—¤ë” í‚¤ë³´ë“œ ì ‘ê·¼ì„± (Enter/Spaceë¡œ ì •ë ¬)
        document.querySelectorAll('th[data-sort]').forEach(th => {
            th.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    th.click();
                }
            });
        });

        // ì´ˆê¸° ë¡œë“œ
        loadData();
    </script>
</body>
</html>
